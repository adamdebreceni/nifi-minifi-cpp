name: "MiNiFi-CPP CI"
on: [push, pull_request, workflow_dispatch]
jobs:
  windows_VS2017:
    name: "windows-vs2017"
    runs-on: windows-2016
    timeout-minutes: 90
    steps:
      - id: checkout
        uses: actions/checkout@v2
      - name: Setup PATH
        uses: microsoft/setup-msbuild@v1.0.2
      - id: build
        run: |
          cd custom-provider
          mc -css Namespace provider.man
          rc provider.rc
          csc /target:library /unsafe /win32res:provider.res provider.cs
          wevtutil im provider.man
        shell: cmd
  windows_VS2019:
    name: "windows-vs2019"
    runs-on: windows-2019
    timeout-minutes: 90
    steps:
      - id: checkout
        uses: actions/checkout@v2
      - name: Setup PATH
        uses: microsoft/setup-msbuild@v1.0.2
      - id: build
        run: |
          cd custom-provider
          mc -css Namespace provider.man
          rc provider.rc
          csc /target:library /unsafe /win32res:provider.res provider.cs
          wevtutil im provider.man
        shell: cmd
